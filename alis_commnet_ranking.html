<!DOCTYPE html>
<html>
  <head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
      <base target="_top">
  </head>
  <body>
  <br>
  <h1><center>ALISコメントランキング</center></h1>

   <P><center><font size ="10">
   ６時間ごとにアップデート。<br>投げ銭ウエルカムかむ
   <a href="https://alis.to/users/haruka">はるか先生</a><br>
   </font>
   </center>
   <br>
   <br>

   <div class="table-responsive">
   <table class="table table-striped  table-condensed">

   <tbody>
   <?
    var sheetidx ="1WibZUfIYFVaIvE9brXEDuRU8HsCSmofBPI5VeOwl1Mc";
    var webAdd;
    var br = "<br>"; //改行
    var userName;
    var eyecatch;

    var myData = SpreadsheetApp.openById(sheetidx).getSheetByName('Ranking').getDataRange().getValues();

    for(var i=0;i<myData.length;i++){
 //pick up article that have comment

     if(myData[i][4] > 4){
       webAdd = '<a href="https://alis.to/' + myData[i][2] + '/articles/' + myData[i][1] +'">' + myData[i][3] + '</a>';
       eyecatch ='<a href="https://alis.to/' + myData[i][2] + '/articles/' + myData[i][1] +'">' + '<img src="' + myData[i][7] + '" width="270px"></a>';

       Logger.log(eyecatch);
       userName = myData[i][5].toString().replace(/,/g,br);

         output.append('<tr>');
         output.append('<th class="align-middle">' + eyecatch  + '</th>');
         output.append('<th class="align-middle"><font size ="10">'+ webAdd + '<br>'+ myData[i][2]　+　'</font></th>');
         output.append('<th class="align-middle"><font size ="10"><center>' + myData[i][4] + '</center></font></th>');
         output.append('</tr>');

       }
      }


    ?>
    </tbody>
    </table>
    </div>
    <br><br><br>

<?!= HtmlService.createHtmlOutputFromFile('js').getContent(); ?>
</body>
</html>
